<!DOCTYPE html>
<html>
<head>
    <title>OnlyKey Configuration Wizard</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="lastMessage">Last message received: <span></span></div>
    <div id="main" class="hide">
        <form id="init-panel" name="init-panel" class="hide">
            <p>
                <a id="show-slot-panel" href="">Setup OnlyKey Slots</a>
            </p>

            <table border="1" cellpadding="5" cellspacing="0" id="HeaderTable">
                <tr>
                    <td data-step="Step1">Step 1: Getting Started</td>
                    <td data-step="Step2">Step 2: Select OnlyKey Mode</td>
                    <td data-step="Step3">Step 3: Set Your PIN</td>
                    <td data-step="Step4">Step 4: Confirm PIN</td>
                    <td data-step="Step5">Step 5: Set Self-Destruct PIN</td>
                    <td data-step="Step6">Step 6: Confirm Self-Destruct PIN</td>
                    <td data-step="Step7">Step 7: Set Plausible Deniability PIN</td>
                    <td data-step="Step8">Step 8: Confirm Plausible Deniability PIN</td>
                </tr>
            </table>

            <br />

            <div id="stepContent">
                <div class="step" id="Step1">
                    <h3>Welcome to the OnlyKey Initial Setup Wizard!</h3>
                    This wizard initializes the OnlyKey. Each step is highlighted in the header. 
                    <br/><br />
                    Click [Next] to get started.
                </div>

                <div class="step" id="Step2">
                    <h3>Step 2: Select OnlyKey Mode</h3>
                    <b>Modes:</b>
                    <br/>
                    <label>
                        <input type=radio name=ConfigMode value="Unencrypted" />
                        Unencrypted Password Manager (International Version)
                    </label>
                    <br/>

                    <label>
                        <input type=radio checked name=ConfigMode value="TwoFactor" />
                        Two-Factor Authentication and Password Manager (U.S. Version - default)
                    </label>
     
                    <br/><br/>
                </div>

                <div class="step" id="Step3">
                    <h3>Step 3: Enter passcode on OnlyKey keypad</h3>
                    <p>
                        WARNING &mdash; Make sure to choose a passcode that you will not forget and that only you know. It is also good to have a secure backup of your passcode somewhere just in case you forget.
                    </p>
                    <p>
                        DISCLAIMER &mdash; I understand that there is no way to recover my passcode and if I forget it the only way to recover the OnlyKey is to perform a factory default which wipes all sensitive information.
                    </p>
                    <label>
                        <input type="checkbox" name="passcode1Disclaimer" />
                        I understand and accept the above risk.
                    </label>
                    <p>
                        Enter a 7 - 10 digit passcode on your OnlyKey six button keypad and when you are finished click [Next] below.
                    </p>
                    <!--<input type="button" name="passcode1Submit" id="passcode1Submit" value="Submit" />-->
                </div>

                <div class="step" id="Step4">
                    <h3>Step 4: Re-enter PIN on OnlyKey Keypad</h3>
                    <p>
                        Re-enter the 7 - 10 digit passcode on your OnlyKey six button keypad and when you are finished click [Next] below.
                    </p>
                    <!--<input type="button" name="passcode1Confirm" id="passcode1Confirm" value="Confirm" />-->
                </div>

                <div class="step" id="Step5">
                    <h3>Step 5. Enter self-destruct passcode on OnlyKey keypad</h3>
                    <p>
                        WARNING &mdash; Make sure to choose a passcode that you will not forget and that only you know. Also this passcode should not be similar to your regular passcode as this could result in unintentionally wiping your OnlyKey. It is your responsibility to maintain a secure backup of your passcode somewhere just in case you forget.
                    </p>
                    <p>
                        DISCLAIMER &mdash; I understand that entering this passcode will cause OnlyKey to perform a factory default which wipes all sensitive information.
                    </p>
                    <label>
                        <input type="checkbox" name="passcode2Disclaimer" />
                        I understand and accept the above risk.
                    </label>
                    <p>
                        Enter a 7 - 10 digit passcode on your OnlyKey six button keypad and when you are finished click [Next] below.
                    </p>
                    <!--<input type="button" name="passcode2Submit" id="passcode2Submit" value="Submit" />-->
                </div>

                <div class="step" id="Step6">
                    <h3>Step 6: Re-enter Self-Destruct PIN on OnlyKey Keypad</h3>
                    <p>
                        Re-enter the 7 - 10 digit passcode on your OnlyKey six button keypad and when you are finished click confirm below.
                    </p>
                    <!--<input type="button" name="passcode2Confirm" id="passcode2Confirm" value="Confirm" />-->
                </div>

                <div class="step" id="Step7">
                    <h3>Step 7: Enter Plausible Deniability PIN on OnlyKey keypad</h3>
                    <p>
                        If you are using Unencrypted Password Manager (International Version) mode or Two-Factor Authentication and Password Manager (U.S. Version - default) mode you may exit now by selecting "Show Configuration" in the left corner of the window. If you have loaded the Plausible Deniability Mode firmware on your OnlyKey proceed to enter plausible deniability passcode.
                    </p>
                    <p>
                        WARNING &mdash; Make sure to choose a passcode that you will not forget and that only you know. It is your responsibility to maintain a secure backup of your passcode somewhere just in case you forget.
                    </p>
                    <p>
                        DISCLAIMER &mdash; I understand that entering this passcode will cause OnlyKey to  perform a factory default which wipes all sensitive information.
                    </p>
                    <label>
                        <input type="checkbox" name="passcode3Disclaimer" />
                        I understand and accept the above risk.
                    </label>
                    <p>
                        Enter a 7 - 10 digit passcode on your OnlyKey six button keypad and when you are finished click submit below.
                    </p>
                    <!--<input type="button" name="passcode2Submit" id="passcode2Submit" value="Submit" />-->
                </div>

                <div class="step" id="Step8">
                    <h3>Step 8: Re-enter Plausible Deniability PIN on OnlyKey Keypad</h3>
                    <p>
                       Re-enter the 7 - 10 digit passcode on your OnlyKey six button keypad and when you are finished click confirm below.
                    </p>
                    <!--<input type="button" name="passcode2Confirm" id="passcode2Confirm" value="Confirm" />-->
                </div>
            </div>
            
            <br />    

            <table border="0" cellpadding="5" cellspacing="0">
                <tr>
                    <td>
                        <button id="ButtonPrevious" type="button" disabled="disabled">Previous</button>
                    </td>
                    <td>
                        <button id="ButtonNext" type="button">Next</button>
                    </td>
                    <td>
                        <button id="SubmitFinal" type="submit" value="Finish" disabled="disabled">Finish</button>
                    </td>
                </tr>
            </table>
        </form>

        <div id="slot-panel" class="hide">
            <p>
                <a id="show-init-panel" href="">Setup OnlyKey PIN</a>
            </p>
            <div class="flex-container">
                <div class="flex-item">
                    <h2>Configure OnlyKey Slots</h2>
                    <table id="slot-config-btns">
                        <tr>
                            <td align="right">
                                <span class="slotLabel" id="slotLabel1a">empty</span>
                                <input type="button" id="slot1aConfig" value="1a"/><br/>
                                <span class="slotLabel" id="slotLabel1b">empty</span>
                                <input type="button" id="slot1bConfig" value="1b"/>
                            </td>
                            <td>
                                <input type="button" id="slot2aConfig" value="2a"/>
                                <span class="slotLabel" id="slotLabel2a">empty</span>
                                <br/>
                                <input type="button" id="slot2bConfig" value="2b"/>
                                <span class="slotLabel" id="slotLabel2b">empty</span>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <span class="slotLabel" id="slotLabel3a">empty</span>
                                <input type="button" id="slot3aConfig" value="3a"/><br/>
                                <span class="slotLabel" id="slotLabel3b">empty</span>
                                <input type="button" id="slot3bConfig" value="3b"/>
                            </td>
                            <td>
                                <input type="button" id="slot4aConfig" value="4a"/>
                                <span class="slotLabel" id="slotLabel4a">empty</span>
                                <br/>
                                <input type="button" id="slot4bConfig" value="4b"/>
                                <span class="slotLabel" id="slotLabel4b">empty</span>
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <span class="slotLabel" id="slotLabel5a">empty</span>
                                <input type="button" id="slot5aConfig" value="5a"/><br/>
                                <span class="slotLabel" id="slotLabel5b">empty</span>
                                <input type="button" id="slot5bConfig" value="5b"/>
                            </td>
                            <td>
                                <input type="button" id="slot6aConfig" value="6a"/>
                                <span class="slotLabel" id="slotLabel6a">empty</span>
                                <br/>
                                <input type="button" id="slot6bConfig" value="6b"/>
                                <span class="slotLabel" id="slotLabel6b">empty</span>
                            </td>
                        </tr>
                    </table>

                    <form id="yubiAuthForm" name="yubiAuthForm" class="auth-form">
                        <h2>Add Yubikey Security Info</h2>
                        <label>
                            Public Identity (6 bytes modhex)
                            <br/>
                            <input type="text" id="yubiPublicId" name="yubiPublicId" maxlength="17" minlength="12" placeholder="public id" required/>
                        </label>
                        <br/>
                        <label>
                            Private Identity (6 bytes hex)
                            <br/>
                            <input type="text" id="yubiPrivateId" name="yubiPrivateId" maxlength="17" minlength="12" placeholder="private id" required/>
                        </label>
                        <br/>
                        <label>
                            Secret Key (16 bytes hex)
                            <br/>
                            <input type="text" id="yubiSecretKey" name="yubiSecretKey" maxlength="47" minlength="32" placeholder="secret aes key" required/>
                        </label>
                        <br/><br/>
                        <input type="button" id="yubiSubmit" name="yubiSubmit" value="Save to OnlyKey" />
                        <input type="button" id="yubiWipe" name="yubiWipe" value="Wipe from OnlyKey" />
                        <div id="yubiError"></div>
                    </form>
                </div>
                <div class="flex-item">
                    <form id="u2fAuthForm" name="u2fAuthForm" class="auth-form">
                        <h2>Add U2F Security Info</h2>
                        <label>
                            Private Identity (32 bytes hex)
                            <br/>
                            <textarea id="u2fPrivateId" name="u2fPrivateId" maxlength="95" minlength="64" cols="40" rows="10" placeholder="private id" required></textarea>
                        </label>
                        <br/>
                        <label>
                            U2F Certificate (up to 1024 bytes hex)
                            <br/>
                            <textarea id="u2fCert" name="u2fCert" maxlength="3071" minlength="2" cols="40" rows="10" placeholder="certificate" required></textarea>
                        </label>
                        <br/><br/>
                        <input type="button" id="u2fSubmit" name="u2fSubmit" value="Save to OnlyKey" />
                        <input type="button" id="u2fWipe" name="u2fWipe" value="Wipe from OnlyKey" />
                        <div id="u2fError"></div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <dialog id="finalStep-dialog">
        <h2>Your OnlyKey is ready!!</h2>
        <a href="" id="closeFinal">Set up slots</a>
    </dialog>

    <dialog id="disconnected-dialog">
        <h1>Please connect your OnlyKey</h1>
    </dialog>

    <dialog id="working-dialog">
        <h1>Working...</h1>
        <h2>Please wait</h2>
    </dialog>

    <dialog id="locked-dialog">
        <h1>Your OnlyKey is locked</h1>
        <h3>Please enter your PIN</h3>
    </dialog>

    <dialog id="slot-wipe-confirm">
        <h2>WIPE OnlyKey Slot <span id="wipeCurrentSlotId">1a</span>??</h2>
<!--         <h3>Label: <span class="wipeCurrentSlotLabel">empty</span></h3>
 -->        <input type="button" id="slotWipeConfirm" name="slotWipeConfirm" value="Wipe"/>
        <input type="button" id="slotWipeCancel" name="slotWipeCancel" value="Cancel"/>
    </dialog>

    <dialog id="slot-config-dialog">
        <a href="" class="slot-config-close">cancel [x]</a>
        <h2>OnlyKey Slot <span class="slotId">1a</span> Configuration</h2>
        <form name="slot-config-form" id="slot-config-form">
            <table>
<!--                 <tr>
                    <td>Load Defaults From Template</td>
                    <td>
                        <select id="templates" name="templates">
                            <option value="test">test</option>  
                        </select>
                    </td>
                </tr> -->
                <tr>
                    <td>
                        <label>
                            <input type="checkbox" id="chkSlotLabel" name="chkSlotLabel" value="true"/>
                            Label
                        </label>
                    </td>
                    <td>
                        <input type="text" id="txtSlotLabel" name="txtSlotLabel" value="" maxlength="10" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="checkbox" id="chkUserName" name="chkUserName" value="true"/>
                            UserName
                        </label>
                    </td>
                    <td>
                        <input type="text" id="txtUserName" name="txtUserName" value="" maxlength="32" />
                    </td>
                </tr>
                <tr>
                     <td>
                        <label>
                            <input type="radio" name="tabReturn1" value=1/>
                            Tab
                        </label>
                        <label>
                            <input type="radio" name="tabReturn1" value=2/>
                            Return
                        </label>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="checkbox" id="chkDelay1" name="chkDelay1" value="true"/>
                            Delay(Seconds)
                        </label>
                    </td>
                    <td>
                        <input type="number" name="numDelay1" value="" min="0" max="255" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="checkbox" id="chkPassword" name="chkPassword" value="true"/>
                            Password
                        </label>
                    </td>
                    <td>
                        <input type="password" id="txtPassword" name="txtPassword" value="" maxlength="30" />
                    </td>
                </tr>
                <tr>
                    <td>Re-enter Password</td>
                    <td>
                        <input type="password" id="txtPasswordConfirm" name="txtPasswordConfirm" value="" maxlength="30" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="radio" name="tabReturn2" value=1/>
                            Tab
                        </label>
                        <label>
                            <input type="radio" name="tabReturn2" value=2/>
                            Return
                        </label>
                    </td>
                </tr>
                <tr>
                    <td>Options below only work for 2FA Mode</td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="checkbox" id="chkDelay2" name="chkDelay2" value="true"/>
                            Delay(Seconds)
                        </label>
                    </td>
                    <td>
                        <input type="number" id="numDelay2" name="numDelay2" value=""/>
                    </td>
                </tr>
                <tr>
                    <td>Please select one:</td>
                </tr>
                <tr>
                    <td>
                        <label>
                            <input type="radio" name="mode" value="googleAuthOtp"/>
                            Google Auth OTP
                        </label>
                        <br/>
                        <label>
                            <input type="radio" name="mode" value="yubikeyOtp"/>
                            Yubikey OTP
                        </label>
                        <br/>
                        <label>
                            <input type="radio" name="mode" value="u2f"/>
                            U2F
                        </label>
                    </td>
                    <td>
                        <input type="text" id="txt2FAUserName" name="txt2FAUserName" value=""/>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" id="slotConfigErrors">
                    </td>
                </tr>
                <tr>
                    <td>
                        <input type="button" id="slotWipe" name="slotWipe" value="Wipe"/>
                    </td>
                    <td>
                        <input type="button" id="slotSubmit" name="slotSubmit" value="Submit"/>
                    </td>
                </tr>
            </table>
        </form>
    </dialog>

    <script src="OnlyKeyWizard.js"></script>
</body>
</html>
